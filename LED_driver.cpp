#include "LED_driver.h"
byte msg[16][MSG_LONG] =
{
    {0x00, 0x00, 0x02, 0x00, 0x00, 0x00, 0x00, 0x20},
    {0x40, 0x08, 0x01, 0x00, 0x40, 0x44, 0x40, 0x28},
    {0x37, 0xfc, 0x3f, 0xfc, 0x27, 0xe4, 0x20, 0x24},
    {0x10, 0x08, 0x20, 0x04, 0x24, 0x54, 0x20, 0x20},
    {0x82, 0x08, 0x40, 0x08, 0x85, 0x54, 0x0f, 0xfe},
    {0x62, 0x08, 0x1f, 0xe0, 0x65, 0x54, 0x00, 0x20},
    {0x22, 0x10, 0x00, 0x40, 0x25, 0x54, 0xe0, 0x20},
    {0x09, 0x10, 0x00, 0x80, 0x0d, 0x54, 0x27, 0xe0},
    {0x11, 0x20, 0x01, 0x04, 0x15, 0x54, 0x21, 0x20},
    {0x20, 0xa0, 0xff, 0xfe, 0x25, 0x54, 0x21, 0x10},
    {0xe0, 0x40, 0x01, 0x00, 0xe5, 0x54, 0x21, 0x10},
    {0x20, 0xa0, 0x01, 0x00, 0x21, 0x04, 0x21, 0x10},
    {0x21, 0x10, 0x01, 0x00, 0x22, 0x84, 0x29, 0xd2},
    {0x22, 0x08, 0x01, 0x00, 0x24, 0x44, 0x37, 0x12},
    {0x24, 0x0e, 0x05, 0x00, 0x28, 0x54, 0x22, 0x0a},
    {0x08, 0x04, 0x02, 0x00, 0x20, 0x08, 0x00, 0x04}
};
byte msg_offset = 0, msg_begin = 0, msg_long = 8;
void senddata(byte data)
{
    byte i;
    for(i = 0; i < 8; i++)
    {
        digitalWrite(CLK, 0);
        if(data & 0x80)
            digitalWrite(R1, 0);
        else
            digitalWrite(R1, 1);
        data = data << 1;
        digitalWrite(CLK, 1);
    }
}
void scan(byte row)
{
    digitalWrite(SignA, (row & 0x01));
    digitalWrite(SignB, (row & 0x02));
    digitalWrite(SignC, (row & 0x04));
    digitalWrite(SignD, (row & 0x08));
}
void show()
{
    byte i, j;
    for(i = 0; i < 16; i++)
    {
        for(j = 0; j < 8; j++)
            senddata((msg[i][(msg_begin + j) % msg_long] << msg_offset) | (msg[i][(msg_begin + j + 1) % msg_long] >> (8 - msg_offset)));
        digitalWrite(EN, 1);
        scan(i);
        digitalWrite(LAT, 0);
        digitalWrite(LAT, 1);
        digitalWrite(EN, 0);
    }
}

